
{
	"type":"JSON-Template",
	"Body":
	{
		"Meta":
		{
			"Version":"0.8.5.0"
		},
		"Head":
		{
			"Selection":
			{
				"ColStart":"9",
				"RowStart":"27",
				"ColEnd":"9",
				"RowEnd":"27"
			},
			"Cols":"100",
			"Rows":"200",
			"DefaultColumnWidth":"70",
			"DefaultRowHeight":"20",
			"Settings":
			{
				"ShowGrid":"true",
				"ShowReportArea":"false"
			},
			"Culture":"zh-CN",
			"Editor":"MainUI V1.0.0.0",
			"DataSources":
			{
				"sql":
				{
					"ClassType":"Bandex.Report.DataSource.SqlStringDataSource",
					"ConnectionString":"Data Source=192.168.0.95;Initial Catalog=BZ2016;User ID=sa;Password=1`q;",
					"QueryString":"SELECT GP_NAME,MAC_NAME,ALARM_NBR,ALARM_DATE,SHIFT_NAME,ALARM_NO,ALARM_MESSAGE,ORG.MEMO  \nFROM ALARM_DATA ORG  \nINNER JOIN MACHINE_INFO MAC\n\t\tON MAC.MAC_NBR=ORG.MAC_NBR\n\tINNER JOIN MACHINE_GROUP_INFO GP\n\t\tON MAC.GP_NBR=GP.GP_NBR \nINNER JOIN ShiftView SV\n\t\tON  (SV.MAC_NBR=MAC.MAC_NBR \nand ALARM_DATE>=SHIFT_BEGIN and ALARM_DATE<SHIFT_END\n)\nwhere (\n({$Machine} is null) OR {$Machine}='' OR dbo.find_in_set(ORG.MAC_NBR,{$Machine})>0 )\nand dbo.find_in_set(MAC.GP_NBR,{$LineName})>0 \nAND\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t({$Shift} IS NULL)\n\t\t\t\t\t\t\t\tOR ({$Shift}='') or\n\t\t\t\t\t\t\t\tdbo.find_in_set(SV.SHIFT_NBR,{$Shift})>0\n\t\t\t\t\t\t\t)\nAND \n\t\t\t\t\t\t\t\t(( SV.Shift_Day>= {$StartDate} )\n\t\t\t\t\t\t\tAND \n\t\t\t\t\t\t\t\tSV.Shift_Day<={$EndDate})",
					"Name":"sql",
					"Paramaters":[
						
						{
							"Name":"{$Machine}",
							"DataType":"AnsiString",
							"Direction":"Input",
							"Default":"\"\"",
							"HasDefault":"true"
						},
						
						{
							"Name":"{$LineName}",
							"DataType":"AnsiString",
							"Direction":"Input",
							"Default":"\"15\"",
							"HasDefault":"true"
						},
						
						{
							"Name":"{$Shift}",
							"DataType":"AnsiString",
							"Direction":"Input",
							"Default":"\"\"",
							"HasDefault":"true"
						},
						
						{
							"Name":"{$StartDate}",
							"DataType":"DateTime",
							"Direction":"Input",
							"Default":"\"2015-08-01T00:00:00\"",
							"HasDefault":"true"
						},
						
						{
							"Name":"{$EndDate}",
							"DataType":"DateTime",
							"Direction":"Input",
							"Default":"\"2015-08-15T00:00:00\"",
							"HasDefault":"true"
						}
					]
				}
			},
			"FreezeRow":"0",
			"FreezeCol":"0",
			"Parameters":
			{
			},
			"dimension":"A1:G4"
		},
		"Style":
		{
			"BackColor":"none",
			"FillPattern":
			{
				"Color":"none",
				"PatternStyleID":"0"
			},
			"TextColor":"Black",
			"Font":"宋体",
			"FontSize":"9",
			"HAlign":"general",
			"VAlign":"middle"
		},
		"Rows":
		{
		},
		"Cols":[
			
			{
				"Col":"2",
				"Width":"110",
				"LastWidth":"168",
				"AutoWidth":"false",
				"Style":
				{
				}
			},
			
			{
				"Col":"6",
				"Width":"210",
				"LastWidth":"70",
				"AutoWidth":"false",
				"Style":
				{
				}
			}
		],
		"HBorder":[
			
			{
				"Row":"0",
				"Col":"0",
				"Cols":"6",
				"Style":"Solid",
				"Pos":"top",
				"Color":"Black"
			},
			
			{
				"Row":"2",
				"Col":"0",
				"Cols":"6",
				"Style":"Solid",
				"Pos":"all",
				"Color":"Black"
			},
			
			{
				"Row":"3",
				"Col":"0",
				"Cols":"6",
				"Style":"Solid",
				"Pos":"all",
				"Color":"Black"
			},
			
			{
				"Row":"4",
				"Col":"0",
				"Cols":"6",
				"Style":"Solid",
				"Pos":"bottom",
				"Color":"Black"
			}
		],
		"VBorder":[
			
			{
				"Row":"0",
				"Col":"0",
				"Rows":"4",
				"Style":"Solid",
				"Pos":"left",
				"Color":"Black"
			},
			
			{
				"Row":"2",
				"Col":"1",
				"Rows":"2",
				"Style":"Solid",
				"Pos":"all",
				"Color":"Black"
			},
			
			{
				"Row":"2",
				"Col":"2",
				"Rows":"2",
				"Style":"Solid",
				"Pos":"all",
				"Color":"Black"
			},
			
			{
				"Row":"2",
				"Col":"3",
				"Rows":"2",
				"Style":"Solid",
				"Pos":"all",
				"Color":"Black"
			},
			
			{
				"Row":"2",
				"Col":"4",
				"Rows":"2",
				"Style":"Solid",
				"Pos":"all",
				"Color":"Black"
			},
			
			{
				"Row":"2",
				"Col":"5",
				"Rows":"2",
				"Style":"Solid",
				"Pos":"all",
				"Color":"Black"
			},
			
			{
				"Row":"0",
				"Col":"6",
				"Rows":"4",
				"Style":"Solid",
				"Pos":"right",
				"Color":"Black"
			}
		],
		"XBorder":
		{
		},
		"Cells":[
			
			{
				"Data":
				{
					"Data":"历史报警分析",
					"DataFormat":"null"
				},
				"Row":"0",
				"Col":"0",
				"Colspan":"6",
				"Rowspan":"2",
				"Area":"none",
				"ExpandDirection":"none",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":"",
				"Style":
				{
					"BackColor":"#d0ffd0",
					"FontSize":"12",
					"HAlign":"center"
				}
			},
			
			{
				"Data":
				{
					"Data":"产线",
					"DataFormat":"null"
				},
				"Row":"2",
				"Col":"0",
				"Area":"none",
				"ExpandDirection":"none",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":"",
				"Style":
				{
					"BackColor":"#ffd0d0"
				}
			},
			
			{
				"Data":
				{
					"Data":"设备",
					"DataFormat":"null"
				},
				"Row":"2",
				"Col":"1",
				"Area":"none",
				"ExpandDirection":"none",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":"",
				"Style":
				{
					"BackColor":"#ffd0d0"
				}
			},
			
			{
				"Data":
				{
					"Data":"报警代码",
					"DataFormat":"null"
				},
				"Row":"2",
				"Col":"2",
				"Area":"none",
				"ExpandDirection":"none",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":"",
				"Style":
				{
					"BackColor":"#ffd0d0"
				}
			},
			
			{
				"Data":
				{
					"Data":"报警内容",
					"DataFormat":"null"
				},
				"Row":"2",
				"Col":"3",
				"Area":"none",
				"ExpandDirection":"none",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":"",
				"Style":
				{
					"BackColor":"#ffd0d0"
				}
			},
			
			{
				"Data":
				{
					"Data":"报警时间",
					"DataFormat":"null"
				},
				"Row":"2",
				"Col":"4",
				"Area":"none",
				"ExpandDirection":"none",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":"",
				"Style":
				{
					"BackColor":"#ffd0d0"
				}
			},
			
			{
				"Data":
				{
					"Data":"所属班次",
					"DataFormat":"null"
				},
				"Row":"2",
				"Col":"5",
				"Area":"none",
				"ExpandDirection":"none",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":"",
				"Style":
				{
					"BackColor":"#ffd0d0"
				}
			},
			
			{
				"Data":
				{
					"Data":"=sql.GP_NAME",
					"DataFormat":"null"
				},
				"Row":"3",
				"Col":"0",
				"Area":"none",
				"ExpandDirection":"toptobottom",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":""
			},
			
			{
				"Data":
				{
					"Data":"=sql.MAC_NAME",
					"DataFormat":"null"
				},
				"Row":"3",
				"Col":"1",
				"Area":"none",
				"ExpandDirection":"toptobottom",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":""
			},
			
			{
				"Data":
				{
					"Data":"=sql.ALARM_NO",
					"DataFormat":"null"
				},
				"Row":"3",
				"Col":"2",
				"Area":"none",
				"ExpandDirection":"toptobottom",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":""
			},
			
			{
				"Data":
				{
					"Data":"=sql.ALARM_MESSAGE",
					"DataFormat":"null"
				},
				"Row":"3",
				"Col":"3",
				"Area":"none",
				"ExpandDirection":"toptobottom",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":""
			},
			
			{
				"Data":
				{
					"Data":"=sql.ALARM_DATE",
					"DataFormat":"null"
				},
				"Row":"3",
				"Col":"4",
				"Area":"none",
				"ExpandDirection":"toptobottom",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":""
			},
			
			{
				"Data":
				{
					"Data":"=sql.SHIFT_NAME",
					"DataFormat":"null"
				},
				"Row":"3",
				"Col":"5",
				"Area":"none",
				"ExpandDirection":"toptobottom",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":""
			},
			
			{
				"Data":
				{
					"Data":"=sql.ALARM_NBR/100",
					"DataFormat":"null"
				},
				"Row":"3",
				"Col":"6",
				"Area":"none",
				"ExpandDirection":"toptobottom",
				"FillType":"list",
				"TopParent":"",
				"LeftParent":""
			}
		],
		"Shapes":
		{
		}
	}
}
